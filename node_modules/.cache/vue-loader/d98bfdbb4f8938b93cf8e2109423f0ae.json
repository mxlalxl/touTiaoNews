{"remainingRequest":"D:\\forward\\code\\vue\\hmtt_nnew\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\forward\\code\\vue\\hmtt_nnew\\src\\views\\Home\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\forward\\code\\vue\\hmtt_nnew\\src\\views\\Home\\index.vue","mtime":1666680537158},{"path":"D:\\forward\\code\\vue\\hmtt_nnew\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1664795348110},{"path":"D:\\forward\\code\\vue\\hmtt_nnew\\node_modules\\babel-loader\\lib\\index.js","mtime":1663989856865},{"path":"D:\\forward\\code\\vue\\hmtt_nnew\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1664795348110},{"path":"D:\\forward\\code\\vue\\hmtt_nnew\\node_modules\\vue-loader\\lib\\index.js","mtime":1664795355419}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgew0KICBnZXRVc2VyQ2hhbm5lbHNBUEksDQogIGdldEFsbENoYW5uZWxMaXN0QVBJLA0KICB1cGRhdGVDaGFubmVsc0FQSSwNCiAgcmVtb3ZlVGhlQ2hhbm5lbEFQSQ0KfSBmcm9tICJAL2FwaSI7DQppbXBvcnQgQXJ0aWNsZUxpc3QgZnJvbSAiLi9jb21wb25lbnRzL0FydGljbGVMaXN0LnZ1ZSI7DQppbXBvcnQgY2hhbm5lbEVkaXQgZnJvbSAiLi9jaGFubmVsRWRpdC52dWUiOw0KaW1wb3J0IHsgTm90aWZ5IH0gZnJvbSAidmFudCI7DQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGNoYW5uZWxJZDogMCwNCiAgICAgIHVzZXJDaGFubmVsTGlzdDogW10sDQogICAgICBhbGxDaGFubmVsTGlzdDogW10sDQogICAgICBzaG93OiBmYWxzZSAvL+aOp+WItumikemBk+W8ueWHuuWxguaYvuekuuaIlumakOiXjw0KICAgICAgLy8gYXJ0aWNsZUxpc3Q6IFtdDQogICAgfTsNCiAgfSwNCiAgYXN5bmMgY3JlYXRlZCgpIHsNCiAgICBjb25zdCByZXMgPSBhd2FpdCBnZXRVc2VyQ2hhbm5lbHNBUEkoKTsNCiAgICAvLyBjb25zb2xlLmxvZyhyZXMpOw0KICAgIHRoaXMudXNlckNoYW5uZWxMaXN0ID0gcmVzLmRhdGEuZGF0YS5jaGFubmVsczsNCg0KICAgIGNvbnN0IHJlczIgPSBhd2FpdCBnZXRBbGxDaGFubmVsTGlzdEFQSSgpOw0KICAgIC8vIGNvbnNvbGUubG9nKHJlczIpOw0KICAgIHRoaXMuYWxsQ2hhbm5lbExpc3QgPSByZXMyLmRhdGEuZGF0YS5jaGFubmVsczsNCiAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmFsbENoYW5uZWxMaXN0KTsNCg0KICAgIC8vIOivt+axguaWh+eroOWIl+ihqA0KICAgIC8vIHRoaXMuY2hhbm5lbENoYW5nZUZuKCk7DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBhc3luYyBjaGFubmVsQ2hhbmdlRm4oKSB7DQogICAgICAvLyBjb25zdCByZXMyID0gYXdhaXQgZ2V0QWxsQXJ0aWNsZUFQSSh7DQogICAgICAvLyAgIGNoYW5uZWxfaWQ6IHRoaXMuY2hhbm5lbElkLA0KICAgICAgLy8gICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkuZ2V0VGltZSgpDQogICAgICAvLyB9KTsNCiAgICAgIC8vIC8vIGNvbnNvbGUubG9nKHJlczIpOw0KICAgICAgLy8gdGhpcy5hcnRpY2xlTGlzdCA9IHJlczIuZGF0YS5kYXRhLnJlc3VsdHM7DQogICAgfSwNCiAgICBwbHVzQ2xpY2tGbigpIHsNCiAgICAgIHRoaXMuc2hvdyA9IHRydWU7DQogICAgfSwNCiAgICAvLyDmt7vliqDpopHpgZMNCiAgICBhc3luYyBhZGRDaGFubmVsRm4oY2hhbm5lbE9iaikgew0KICAgICAgdGhpcy51c2VyQ2hhbm5lbExpc3QucHVzaChjaGFubmVsT2JqKTsNCg0KICAgICAgY29uc3QgbmV3QXJyID0gdGhpcy51c2VyQ2hhbm5lbExpc3QuZmlsdGVyKG9iaiA9PiBvYmouaWQgIT09IDApOw0KICAgICAgY29uc3QgdGhlTmV3QXJyID0gbmV3QXJyLm1hcCgob2JqLCBpbmRleCkgPT4gew0KICAgICAgICBjb25zdCBuZXdPYmogPSB7IC4uLm9iaiB9OyAvL+aLt+i0nQ0KICAgICAgICBkZWxldGUgbmV3T2JqLm5hbWU7DQogICAgICAgIG5ld09iai5zZXEgPSBpbmRleDsNCiAgICAgICAgcmV0dXJuIG5ld09iajsgLy/orqltYXDmiormlrDlr7nosaHmlLbpm4botbfmnaUNCiAgICAgIH0pOw0KICAgICAgY29uc3QgcmVzID0gYXdhaXQgdXBkYXRlQ2hhbm5lbHNBUEkoew0KICAgICAgICBjaGFubmVsczogdGhlTmV3QXJyDQogICAgICB9KTsNCiAgICB9LA0KICAgIC8v55So5oi356e76Zmk5bey6YCJ6aKR6YGTDQogICAgYXN5bmMgcmVtb3ZlQ2hhbm5lbEZuKGNoYW5uZWxPYmopIHsNCiAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy51c2VyQ2hhbm5lbExpc3QuZmluZEluZGV4KA0KICAgICAgICBvYmogPT4gb2JqLmlkID09PSBjaGFubmVsT2JqLmlkDQogICAgICApOw0KICAgICAgdGhpcy51c2VyQ2hhbm5lbExpc3Quc3BsaWNlKGluZGV4LCAxKTsNCiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJlbW92ZVRoZUNoYW5uZWxBUEkoeyBjaGFubmVsSWQ6IGNoYW5uZWxPYmouaWQgfSk7DQogICAgICBOb3RpZnkoeyB0eXBlOiAic3VjY2VzcyIsIG1lc3NhZ2U6ICLliKDpmaTmiJDlip8iIH0pOw0KICAgIH0sDQogICAgLy8g5YWz6Zet5by55Ye65bGCDQogICAgY2xvc2VGbigpIHsNCiAgICAgIHRoaXMuc2hvdyA9IGZhbHNlOw0KICAgICAgdGhpcy4kcmVmcy5lZGl0UmVmLmlzRWRpdCA9IGZhbHNlOw0KICAgIH0sDQogICAgLy8g6aaW6aG1LeWPs+S4iuinkuaUvuWkp+mVnOeCueWHu+S6i+S7ti0tPiDot7Povazoh7PmkJzntKLpobXpnaINCiAgICBtb3ZlU2VhcmNoUGFnZUZuKCkgew0KICAgICAgdGhpcy4kcm91dGVyLnB1c2goIi9zZWFyY2giKTsNCiAgICB9DQogIH0sDQogIGNvbXBvbmVudHM6IHsNCiAgICBBcnRpY2xlTGlzdCwNCiAgICBjaGFubmVsRWRpdA0KICB9LA0KICBjb21wdXRlZDogew0KICAgIHVuQ2hlY2tDaGFubmVsTGlzdCgpIHsNCiAgICAgIC8vIOaKiuaJgOaciemikemBk+WIl+ihqOaVsOe7hOWvueixoeaMqOS4quWPluWHuu+8jOWOu+eUqOaIt+W3sumAiemikemBk+aVsOe7hOmHjOafpeaJvu+8jOWmguaenOafpeS4jeWIsO+8jOiuqWZpbHRlcuaWueazleWwhuWFtuaUtumbhuWIsOS4gOS4quaWsOeahOaVsOe7hOS4rQ0KICAgICAgY29uc3QgbmV3QXJyID0gdGhpcy5hbGxDaGFubmVsTGlzdC5maWx0ZXIoYmlnT2JqID0+IHsNCiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnVzZXJDaGFubmVsTGlzdC5maW5kSW5kZXgoc21hbGxPYmogPT4gew0KICAgICAgICAgIHJldHVybiBzbWFsbE9iai5pZCA9PT0gYmlnT2JqLmlkOw0KICAgICAgICB9KTsNCg0KICAgICAgICAvLyDlpoLmnpzmib7liLDkuoYNCiAgICAgICAgaWYgKGluZGV4ID4gLTEpIHsNCiAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgICAgIH0pOw0KICAgICAgcmV0dXJuIG5ld0FycjsNCiAgICB9DQogIH0NCn07DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAgDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/Home","sourcesContent":["<template>\r\n  <div>\r\n    <!-- 头部导航 -->\r\n    <div>\r\n      <van-nav-bar fixed>\r\n        <template v-slot:left>\r\n          <img src=\"@/assets/logo.png\" alt class=\"logo\" />\r\n        </template>\r\n        <template #right>\r\n          <van-icon name=\"search\" size=\"0.48rem\" color=\"#fff\" @click=\"moveSearchPageFn\" />\r\n        </template>\r\n      </van-nav-bar>\r\n    </div>\r\n    <!--标签栏 -->\r\n    <div class=\"main\">\r\n      <van-tabs\r\n        v-model=\"channelId\"\r\n        sticky\r\n        offset-top=\"1.22667rem\"\r\n        animated\r\n        @change=\"channelChangeFn\"\r\n      >\r\n        <van-tab :title=\"obj.name\" :key=\"obj.id\" v-for=\"obj in userChannelList\" :name=\"obj.id\">\r\n          <ArticleList :channelId=\"channelId\"></ArticleList>\r\n        </van-tab>\r\n      </van-tabs>\r\n\r\n      <!-- 编辑频道图标 -->\r\n      <van-icon name=\"plus\" size=\"0.37333334rem\" class=\"moreChannels\" @click=\"plusClickFn\" />\r\n    </div>\r\n\r\n    <!-- 频道管理弹出层 -->\r\n    <van-popup v-model=\"show\" get-container=\"body\" class=\"channel_popup\">\r\n      <!-- ref属性可以拿到当前绑定的组件对象，就可以拿到此组件对象身上的所有属性和方法 -->\r\n      <channel-edit\r\n        :userChannelList=\"userChannelList\"\r\n        :unCheckList=\"unCheckChannelList\"\r\n        @addChannelEV=\"addChannelFn\"\r\n        @removeChannelEV=\"removeChannelFn\"\r\n        @closeEV=\"closeFn\"\r\n        ref=\"editRef\"\r\n        v-model=\"channelId\"\r\n      ></channel-edit>\r\n    </van-popup>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  getUserChannelsAPI,\r\n  getAllChannelListAPI,\r\n  updateChannelsAPI,\r\n  removeTheChannelAPI\r\n} from \"@/api\";\r\nimport ArticleList from \"./components/ArticleList.vue\";\r\nimport channelEdit from \"./channelEdit.vue\";\r\nimport { Notify } from \"vant\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      channelId: 0,\r\n      userChannelList: [],\r\n      allChannelList: [],\r\n      show: false //控制频道弹出层显示或隐藏\r\n      // articleList: []\r\n    };\r\n  },\r\n  async created() {\r\n    const res = await getUserChannelsAPI();\r\n    // console.log(res);\r\n    this.userChannelList = res.data.data.channels;\r\n\r\n    const res2 = await getAllChannelListAPI();\r\n    // console.log(res2);\r\n    this.allChannelList = res2.data.data.channels;\r\n    // console.log(this.allChannelList);\r\n\r\n    // 请求文章列表\r\n    // this.channelChangeFn();\r\n  },\r\n  methods: {\r\n    async channelChangeFn() {\r\n      // const res2 = await getAllArticleAPI({\r\n      //   channel_id: this.channelId,\r\n      //   timestamp: new Date().getTime()\r\n      // });\r\n      // // console.log(res2);\r\n      // this.articleList = res2.data.data.results;\r\n    },\r\n    plusClickFn() {\r\n      this.show = true;\r\n    },\r\n    // 添加频道\r\n    async addChannelFn(channelObj) {\r\n      this.userChannelList.push(channelObj);\r\n\r\n      const newArr = this.userChannelList.filter(obj => obj.id !== 0);\r\n      const theNewArr = newArr.map((obj, index) => {\r\n        const newObj = { ...obj }; //拷贝\r\n        delete newObj.name;\r\n        newObj.seq = index;\r\n        return newObj; //让map把新对象收集起来\r\n      });\r\n      const res = await updateChannelsAPI({\r\n        channels: theNewArr\r\n      });\r\n    },\r\n    //用户移除已选频道\r\n    async removeChannelFn(channelObj) {\r\n      const index = this.userChannelList.findIndex(\r\n        obj => obj.id === channelObj.id\r\n      );\r\n      this.userChannelList.splice(index, 1);\r\n      const res = await removeTheChannelAPI({ channelId: channelObj.id });\r\n      Notify({ type: \"success\", message: \"删除成功\" });\r\n    },\r\n    // 关闭弹出层\r\n    closeFn() {\r\n      this.show = false;\r\n      this.$refs.editRef.isEdit = false;\r\n    },\r\n    // 首页-右上角放大镜点击事件--> 跳转至搜索页面\r\n    moveSearchPageFn() {\r\n      this.$router.push(\"/search\");\r\n    }\r\n  },\r\n  components: {\r\n    ArticleList,\r\n    channelEdit\r\n  },\r\n  computed: {\r\n    unCheckChannelList() {\r\n      // 把所有频道列表数组对象挨个取出，去用户已选频道数组里查找，如果查不到，让filter方法将其收集到一个新的数组中\r\n      const newArr = this.allChannelList.filter(bigObj => {\r\n        const index = this.userChannelList.findIndex(smallObj => {\r\n          return smallObj.id === bigObj.id;\r\n        });\r\n\r\n        // 如果找到了\r\n        if (index > -1) {\r\n          return false;\r\n        } else {\r\n          return true;\r\n        }\r\n      });\r\n      return newArr;\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.logo {\r\n  width: 2.67rem;\r\n  height: 0.8rem;\r\n}\r\n.main {\r\n  padding-top: 1.22rem;\r\n}\r\n\r\n/* 设置tabs容器样式 */\r\n/deep/ .van-tabs_wrap {\r\n  padding-right: 30px;\r\n  background-color: #fff;\r\n}\r\n\r\n/* 设置小图标的样式 */\r\n.moreChannels {\r\n  position: fixed;\r\n  top: 1.65333333rem;\r\n  right: 0.08rem;\r\n  z-index: 999;\r\n}\r\n\r\n/* 频道弹出层样式 */\r\n.channel_popup {\r\n  width: 100vw;\r\n  height: 100vh;\r\n}\r\n</style>"]}]}