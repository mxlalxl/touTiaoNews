{"remainingRequest":"D:\\myProject\\touTiaoNews\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\myProject\\touTiaoNews\\src\\views\\Home\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\myProject\\touTiaoNews\\src\\views\\Home\\index.vue","mtime":1694051857320},{"path":"D:\\myProject\\touTiaoNews\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1664795348110},{"path":"D:\\myProject\\touTiaoNews\\node_modules\\babel-loader\\lib\\index.js","mtime":1663989856865},{"path":"D:\\myProject\\touTiaoNews\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1664795348110},{"path":"D:\\myProject\\touTiaoNews\\node_modules\\vue-loader\\lib\\index.js","mtime":1664795355419}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgew0KICBnZXRVc2VyQ2hhbm5lbHNBUEksDQogIGdldEFsbENoYW5uZWxMaXN0QVBJLA0KICB1cGRhdGVDaGFubmVsc0FQSSwNCiAgcmVtb3ZlVGhlQ2hhbm5lbEFQSQ0KfSBmcm9tICJAL2FwaSI7DQppbXBvcnQgQXJ0aWNsZUxpc3QgZnJvbSAiLi9jb21wb25lbnRzL0FydGljbGVMaXN0LnZ1ZSI7DQppbXBvcnQgY2hhbm5lbEVkaXQgZnJvbSAiLi9jaGFubmVsRWRpdC52dWUiOw0KaW1wb3J0IE5vdGlmeSBmcm9tICJAL3VpL05vdGlmeS5qcyI7DQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGNoYW5uZWxJZDogMCwNCiAgICAgIHVzZXJDaGFubmVsTGlzdDogW10sDQogICAgICBhbGxDaGFubmVsTGlzdDogW10sDQogICAgICBzaG93OiBmYWxzZSwgLy/mjqfliLbpopHpgZPlvLnlh7rlsYLmmL7npLrmiJbpmpDol48NCiAgICAgIC8vIGFydGljbGVMaXN0OiBbXQ0KICAgICAgY2hhbm5lbFNjcm9sbFRPYmo6IHt9IC8v5L+d5a2Y5q+P5Liq6aKR6YGT55qE5rua5Yqo6auY5bqmDQogICAgfTsNCiAgfSwNCiAgYXN5bmMgY3JlYXRlZCgpIHsNCiAgICBjb25zdCByZXMgPSBhd2FpdCBnZXRVc2VyQ2hhbm5lbHNBUEkoKTsNCiAgICAvLyBjb25zb2xlLmxvZyhyZXMpOw0KICAgIHRoaXMudXNlckNoYW5uZWxMaXN0ID0gcmVzLmRhdGEuZGF0YS5jaGFubmVsczsNCg0KICAgIGNvbnN0IHJlczIgPSBhd2FpdCBnZXRBbGxDaGFubmVsTGlzdEFQSSgpOw0KICAgIC8vIGNvbnNvbGUubG9nKHJlczIpOw0KICAgIHRoaXMuYWxsQ2hhbm5lbExpc3QgPSByZXMyLmRhdGEuZGF0YS5jaGFubmVsczsNCiAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmFsbENoYW5uZWxMaXN0KTsNCg0KICAgIC8vIOivt+axguaWh+eroOWIl+ihqA0KICAgIC8vIHRoaXMuY2hhbm5lbENoYW5nZUZuKCk7DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBhc3luYyBjaGFubmVsQ2hhbmdlRm4oKSB7DQogICAgICAvLyBjb25zdCByZXMyID0gYXdhaXQgZ2V0QWxsQXJ0aWNsZUFQSSh7DQogICAgICAvLyAgIGNoYW5uZWxfaWQ6IHRoaXMuY2hhbm5lbElkLA0KICAgICAgLy8gICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkuZ2V0VGltZSgpDQogICAgICAvLyB9KTsNCiAgICAgIC8vIC8vIGNvbnNvbGUubG9nKHJlczIpOw0KICAgICAgLy8gdGhpcy5hcnRpY2xlTGlzdCA9IHJlczIuZGF0YS5kYXRhLnJlc3VsdHM7DQoNCiAgICAgIC8v55uR5ZCs6aKR6YGT5pS55Y+Y5LqL5Lu2DQogICAgICAvLyB0YWLliIfmjaLlkI7vvIzorr7nva7mu5rliqjmnaHnmoTkvY3nva4NCiAgICAgIC8vIHRhYuWIh+aNouaXtu+8jOe7hOS7tuWGhemDqOS8muaKiuWIh+i1sOeahOWuueWZqOmrmOW6puiuvue9ruS4ujDvvIzliIflm57mnaXnmoTkuIDnnqzpl7TpobXpnaLpq5jluqbkuLow77yM5rua5Yqo5LqL5Lu26KKr6Kem5Y+R77yMDQogICAgICAvLyDmu5rliqjmnaHmu5rlm57liLDpobbpg6jvvIzmiormu5rliqjmnaHnmoTmlbDmja7lj5jkuLow77yM6K6+572u5rua5Yqo5L2N572u5Lmf5rKh55So44CCDQogICAgICAvLyDop6PlhrPvvJrlhYjorqlkb23mm7TmlrDvvIzlho3lrZgNCiAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsNCiAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCA9IHRoaXMuY2hhbm5lbFNjcm9sbFRPYmpbDQogICAgICAgICAgdGhpcy5jaGFubmVsSWQNCiAgICAgICAgXTsNCiAgICAgIH0pOw0KICAgIH0sDQogICAgcGx1c0NsaWNrRm4oKSB7DQogICAgICB0aGlzLnNob3cgPSB0cnVlOw0KICAgIH0sDQogICAgLy8g5re75Yqg6aKR6YGTDQogICAgYXN5bmMgYWRkQ2hhbm5lbEZuKGNoYW5uZWxPYmopIHsNCiAgICAgIHRoaXMudXNlckNoYW5uZWxMaXN0LnB1c2goY2hhbm5lbE9iaik7DQoNCiAgICAgIGNvbnN0IG5ld0FyciA9IHRoaXMudXNlckNoYW5uZWxMaXN0LmZpbHRlcihvYmogPT4gb2JqLmlkICE9PSAwKTsNCiAgICAgIGNvbnN0IHRoZU5ld0FyciA9IG5ld0Fyci5tYXAoKG9iaiwgaW5kZXgpID0+IHsNCiAgICAgICAgY29uc3QgbmV3T2JqID0geyAuLi5vYmogfTsgLy/mi7fotJ0NCiAgICAgICAgZGVsZXRlIG5ld09iai5uYW1lOw0KICAgICAgICBuZXdPYmouc2VxID0gaW5kZXg7DQogICAgICAgIHJldHVybiBuZXdPYmo7IC8v6K6pbWFw5oqK5paw5a+56LGh5pS26ZuG6LW35p2lDQogICAgICB9KTsNCiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHVwZGF0ZUNoYW5uZWxzQVBJKHsNCiAgICAgICAgY2hhbm5lbHM6IHRoZU5ld0Fycg0KICAgICAgfSk7DQogICAgfSwNCiAgICAvL+eUqOaIt+enu+mZpOW3sumAiemikemBkw0KICAgIGFzeW5jIHJlbW92ZUNoYW5uZWxGbihjaGFubmVsT2JqKSB7DQogICAgICBjb25zdCBpbmRleCA9IHRoaXMudXNlckNoYW5uZWxMaXN0LmZpbmRJbmRleCgNCiAgICAgICAgb2JqID0+IG9iai5pZCA9PT0gY2hhbm5lbE9iai5pZA0KICAgICAgKTsNCiAgICAgIHRoaXMudXNlckNoYW5uZWxMaXN0LnNwbGljZShpbmRleCwgMSk7DQogICAgICBjb25zdCByZXMgPSBhd2FpdCByZW1vdmVUaGVDaGFubmVsQVBJKHsgY2hhbm5lbElkOiBjaGFubmVsT2JqLmlkIH0pOw0KICAgICAgTm90aWZ5KHsgdHlwZTogInN1Y2Nlc3MiLCBtZXNzYWdlOiAi5Yig6Zmk5oiQ5YqfIiB9KTsNCiAgICB9LA0KICAgIC8vIOWFs+mXreW8ueWHuuWxgg0KICAgIGNsb3NlRm4oKSB7DQogICAgICB0aGlzLnNob3cgPSBmYWxzZTsNCiAgICAgIHRoaXMuJHJlZnMuZWRpdFJlZi5pc0VkaXQgPSBmYWxzZTsNCiAgICB9LA0KICAgIC8vIOmmlumhtS3lj7PkuIrop5LmlL7lpKfplZzngrnlh7vkuovku7YtLT4g6Lez6L2s6Iez5pCc57Si6aG16Z2iDQogICAgbW92ZVNlYXJjaFBhZ2VGbigpIHsNCiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvc2VhcmNoIik7DQogICAgfSwNCiAgICAvLyDojrflj5bmu5rliqjmnaHkvY3nva4NCiAgICBzY3JvbGxGbigpIHsNCiAgICAgIC8vIOiwt+atjOa1j+iniOWZqOWSjOWuieWNk+aJi+acuuWGhee9rueahOa1j+iniOWZqOWGheaguOS4jeaYr+WQjOS4gOS4qu+8jOiOt+WPlnNjcm9sbFRvcOeahOaWueW8j+S4jeWQjA0KICAgICAgLy8g6LC35q2M5rWP6KeI5Zmo55So55qEaHRtbOeahHNjcm9sbFRvcCzlronljZPnlKjnmoRib2R555qEc2Nyb2xsVG9wDQogICAgICB0aGlzLiRyb3V0ZS5tZXRhLnNjcm9sbFQgPQ0KICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wIHx8IGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wOw0KICAgICAgLy8g5L+d5a2Y5b2T5YmN6aKR6YGT55qE5rua5Yqo6Led56a7DQogICAgICB0aGlzLmNoYW5uZWxTY3JvbGxUT2JqW3RoaXMuY2hhbm5lbElkXSA9DQogICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AgfHwgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3A7DQogICAgfQ0KICB9LA0KICBjb21wb25lbnRzOiB7DQogICAgQXJ0aWNsZUxpc3QsDQogICAgY2hhbm5lbEVkaXQNCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICB1bkNoZWNrQ2hhbm5lbExpc3QoKSB7DQogICAgICAvLyDmiormiYDmnInpopHpgZPliJfooajmlbDnu4Tlr7nosaHmjKjkuKrlj5blh7rvvIzljrvnlKjmiLflt7LpgInpopHpgZPmlbDnu4Tph4zmn6Xmib7vvIzlpoLmnpzmn6XkuI3liLDvvIzorqlmaWx0ZXLmlrnms5XlsIblhbbmlLbpm4bliLDkuIDkuKrmlrDnmoTmlbDnu4TkuK0NCiAgICAgIGNvbnN0IG5ld0FyciA9IHRoaXMuYWxsQ2hhbm5lbExpc3QuZmlsdGVyKGJpZ09iaiA9PiB7DQogICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy51c2VyQ2hhbm5lbExpc3QuZmluZEluZGV4KHNtYWxsT2JqID0+IHsNCiAgICAgICAgICByZXR1cm4gc21hbGxPYmouaWQgPT09IGJpZ09iai5pZDsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgLy8g5aaC5p6c5om+5Yiw5LqGDQogICAgICAgIGlmIChpbmRleCA+IC0xKSB7DQogICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICAgIHJldHVybiBuZXdBcnI7DQogICAgfQ0KICB9LA0KDQogIC8vIOaciee7hOS7tue8k+WtmO+8jOe7hOS7tuWIh+WbnuadpeaXtuaJp+ihjGFjdGl2YXRlZCznu4Tku7bliIfotbDml7bmiafooYxkZWFjdGl2YXRlZA0KICBhY3RpdmF0ZWQoKSB7DQogICAgLy8gY29uc29sZS5sb2codGhpcy4kcm91dGUpOw0KICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJzY3JvbGwiLCB0aGlzLnNjcm9sbEZuKTsNCiAgICAvLyB3aW5kb3flkoxkb2N1bWVudO+8jOebkeWQrOe9kemhtea7muWKqOS6i+S7tg0KICAgIC8vIGh0bWzmoIfnrb7ojrflj5ZzY3JvbGxUb3As5rua5Yqo55qE6Led56a75ZKM6K6+572u5rua5Yqo55qE5L2N572uDQogICAgLy8g56uL5Yi76K6+572u5rua5Yqo5p2h55qE5L2N572uDQogICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCA9IHRoaXMuJHJvdXRlLm1ldGEuc2Nyb2xsVDsNCiAgICBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCA9IHRoaXMuJHJvdXRlLm1ldGEuc2Nyb2xsVDsNCiAgfSwNCiAgZGVhY3RpdmF0ZWQoKSB7DQogICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoInNjcm9sbCIsIHRoaXMuc2Nyb2xsRm4pOw0KICB9DQp9Ow0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAgDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/Home","sourcesContent":["<template>\r\n  <div>\r\n    <!-- 头部导航 -->\r\n    <div>\r\n      <van-nav-bar fixed>\r\n        <template v-slot:left>\r\n          <img src=\"@/assets/logo.png\" alt class=\"logo\" />\r\n        </template>\r\n        <template #right>\r\n          <van-icon name=\"search\" size=\"0.48rem\" color=\"#fff\" @click=\"moveSearchPageFn\" />\r\n        </template>\r\n      </van-nav-bar>\r\n    </div>\r\n    <!--标签栏 -->\r\n    <div class=\"main\">\r\n      <van-tabs\r\n        v-model=\"channelId\"\r\n        sticky\r\n        offset-top=\"1.22667rem\"\r\n        animated\r\n        @change=\"channelChangeFn\"\r\n      >\r\n        <van-tab :title=\"obj.name\" :key=\"obj.id\" v-for=\"obj in userChannelList\" :name=\"obj.id\">\r\n          <ArticleList :channelId=\"channelId\"></ArticleList>\r\n        </van-tab>\r\n      </van-tabs>\r\n\r\n      <!-- 编辑频道图标 -->\r\n      <van-icon name=\"plus\" size=\"0.37333334rem\" class=\"moreChannels\" @click=\"plusClickFn\" />\r\n    </div>\r\n\r\n    <!-- 频道管理弹出层 -->\r\n    <van-popup v-model=\"show\" get-container=\"body\" class=\"channel_popup\">\r\n      <!-- ref属性可以拿到当前绑定的组件对象，就可以拿到此组件对象身上的所有属性和方法 -->\r\n      <channel-edit\r\n        :userChannelList=\"userChannelList\"\r\n        :unCheckList=\"unCheckChannelList\"\r\n        @addChannelEV=\"addChannelFn\"\r\n        @removeChannelEV=\"removeChannelFn\"\r\n        @closeEV=\"closeFn\"\r\n        ref=\"editRef\"\r\n        v-model=\"channelId\"\r\n      ></channel-edit>\r\n    </van-popup>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  getUserChannelsAPI,\r\n  getAllChannelListAPI,\r\n  updateChannelsAPI,\r\n  removeTheChannelAPI\r\n} from \"@/api\";\r\nimport ArticleList from \"./components/ArticleList.vue\";\r\nimport channelEdit from \"./channelEdit.vue\";\r\nimport Notify from \"@/ui/Notify.js\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      channelId: 0,\r\n      userChannelList: [],\r\n      allChannelList: [],\r\n      show: false, //控制频道弹出层显示或隐藏\r\n      // articleList: []\r\n      channelScrollTObj: {} //保存每个频道的滚动高度\r\n    };\r\n  },\r\n  async created() {\r\n    const res = await getUserChannelsAPI();\r\n    // console.log(res);\r\n    this.userChannelList = res.data.data.channels;\r\n\r\n    const res2 = await getAllChannelListAPI();\r\n    // console.log(res2);\r\n    this.allChannelList = res2.data.data.channels;\r\n    // console.log(this.allChannelList);\r\n\r\n    // 请求文章列表\r\n    // this.channelChangeFn();\r\n  },\r\n  methods: {\r\n    async channelChangeFn() {\r\n      // const res2 = await getAllArticleAPI({\r\n      //   channel_id: this.channelId,\r\n      //   timestamp: new Date().getTime()\r\n      // });\r\n      // // console.log(res2);\r\n      // this.articleList = res2.data.data.results;\r\n\r\n      //监听频道改变事件\r\n      // tab切换后，设置滚动条的位置\r\n      // tab切换时，组件内部会把切走的容器高度设置为0，切回来的一瞬间页面高度为0，滚动事件被触发，\r\n      // 滚动条滚回到顶部，把滚动条的数据变为0，设置滚动位置也没用。\r\n      // 解决：先让dom更新，再存\r\n      this.$nextTick(() => {\r\n        document.documentElement.scrollTop = this.channelScrollTObj[\r\n          this.channelId\r\n        ];\r\n      });\r\n    },\r\n    plusClickFn() {\r\n      this.show = true;\r\n    },\r\n    // 添加频道\r\n    async addChannelFn(channelObj) {\r\n      this.userChannelList.push(channelObj);\r\n\r\n      const newArr = this.userChannelList.filter(obj => obj.id !== 0);\r\n      const theNewArr = newArr.map((obj, index) => {\r\n        const newObj = { ...obj }; //拷贝\r\n        delete newObj.name;\r\n        newObj.seq = index;\r\n        return newObj; //让map把新对象收集起来\r\n      });\r\n      const res = await updateChannelsAPI({\r\n        channels: theNewArr\r\n      });\r\n    },\r\n    //用户移除已选频道\r\n    async removeChannelFn(channelObj) {\r\n      const index = this.userChannelList.findIndex(\r\n        obj => obj.id === channelObj.id\r\n      );\r\n      this.userChannelList.splice(index, 1);\r\n      const res = await removeTheChannelAPI({ channelId: channelObj.id });\r\n      Notify({ type: \"success\", message: \"删除成功\" });\r\n    },\r\n    // 关闭弹出层\r\n    closeFn() {\r\n      this.show = false;\r\n      this.$refs.editRef.isEdit = false;\r\n    },\r\n    // 首页-右上角放大镜点击事件--> 跳转至搜索页面\r\n    moveSearchPageFn() {\r\n      this.$router.push(\"/search\");\r\n    },\r\n    // 获取滚动条位置\r\n    scrollFn() {\r\n      // 谷歌浏览器和安卓手机内置的浏览器内核不是同一个，获取scrollTop的方式不同\r\n      // 谷歌浏览器用的html的scrollTop,安卓用的body的scrollTop\r\n      this.$route.meta.scrollT =\r\n        document.documentElement.scrollTop || document.body.scrollTop;\r\n      // 保存当前频道的滚动距离\r\n      this.channelScrollTObj[this.channelId] =\r\n        document.documentElement.scrollTop || document.body.scrollTop;\r\n    }\r\n  },\r\n  components: {\r\n    ArticleList,\r\n    channelEdit\r\n  },\r\n  computed: {\r\n    unCheckChannelList() {\r\n      // 把所有频道列表数组对象挨个取出，去用户已选频道数组里查找，如果查不到，让filter方法将其收集到一个新的数组中\r\n      const newArr = this.allChannelList.filter(bigObj => {\r\n        const index = this.userChannelList.findIndex(smallObj => {\r\n          return smallObj.id === bigObj.id;\r\n        });\r\n\r\n        // 如果找到了\r\n        if (index > -1) {\r\n          return false;\r\n        } else {\r\n          return true;\r\n        }\r\n      });\r\n      return newArr;\r\n    }\r\n  },\r\n\r\n  // 有组件缓存，组件切回来时执行activated,组件切走时执行deactivated\r\n  activated() {\r\n    // console.log(this.$route);\r\n    window.addEventListener(\"scroll\", this.scrollFn);\r\n    // window和document，监听网页滚动事件\r\n    // html标签获取scrollTop,滚动的距离和设置滚动的位置\r\n    // 立刻设置滚动条的位置\r\n    document.documentElement.scrollTop = this.$route.meta.scrollT;\r\n    document.body.scrollTop = this.$route.meta.scrollT;\r\n  },\r\n  deactivated() {\r\n    window.removeEventListener(\"scroll\", this.scrollFn);\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.logo {\r\n  width: 2.67rem;\r\n  height: 0.8rem;\r\n}\r\n.main {\r\n  padding-top: 1.22rem;\r\n}\r\n\r\n/* 设置tabs容器样式 */\r\n/deep/ .van-tabs_wrap {\r\n  padding-right: 30px;\r\n  background-color: #fff;\r\n}\r\n\r\n/* 设置小图标的样式 */\r\n.moreChannels {\r\n  position: fixed;\r\n  top: 1.65333333rem;\r\n  right: 0.08rem;\r\n  z-index: 999;\r\n}\r\n\r\n/* 频道弹出层样式 */\r\n.channel_popup {\r\n  width: 100vw;\r\n  height: 100vh;\r\n}\r\n</style>"]}]}