{"remainingRequest":"D:\\myProject\\touTiaoNews\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\myProject\\touTiaoNews\\src\\views\\Login\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\myProject\\touTiaoNews\\src\\views\\Login\\index.vue","mtime":1694051857320},{"path":"D:\\myProject\\touTiaoNews\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1664795348110},{"path":"D:\\myProject\\touTiaoNews\\node_modules\\babel-loader\\lib\\index.js","mtime":1663989856865},{"path":"D:\\myProject\\touTiaoNews\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1664795348110},{"path":"D:\\myProject\\touTiaoNews\\node_modules\\vue-loader\\lib\\index.js","mtime":1664795355419}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgeyBsb2dpbkFQSSB9IGZyb20gIkAvYXBpIjsNCmltcG9ydCBOb3RpZnkgZnJvbSAiQC91aS9Ob3RpZnkuanMiOw0KaW1wb3J0IHsgc2V0VG9rZW4gfSBmcm9tICJAL3V0aWxzL3Rva2VuLmpzIjsNCmltcG9ydCB7IHNldFN0b3JhZ2UgfSBmcm9tICJAL3V0aWxzL3N0b3JhZ2UuanMiOw0KZXhwb3J0IGRlZmF1bHQgew0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICB1c2VyOiB7DQogICAgICAgIG1vYmlsZTogIiIsIC8v5omL5py65Y+3DQogICAgICAgIGNvZGU6ICIiIC8v5a+G56CBDQogICAgICB9LA0KICAgICAgaXNsb2FkaW5nOiBmYWxzZQ0KICAgIH07DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBhc3luYyBvblN1Ym1pdCh2YWx1ZXMpIHsNCiAgICAgIC8vIGNvbnNvbGUubG9nKCJzdWJtaXQiLCB2YWx1ZXMpOw0KICAgICAgLy8gY29uc29sZS5sb2codGhpcy51c2VyKTsNCiAgICAgIC8vIOaKiueKtuaAgeiuvue9ruS4unRydWUNCiAgICAgIHRoaXMuaXNsb2FkaW5nID0gdHJ1ZTsNCg0KICAgICAgdHJ5IHsNCiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgbG9naW5BUEkodGhpcy51c2VyKTsNCiAgICAgICAgLy8gY29uc29sZS5sb2cocmVzKTsNCiAgICAgICAgLy8g5oiQ5Yqf6YCa55+lDQogICAgICAgIE5vdGlmeSh7IHR5cGU6ICJzdWNjZXNzIiwgbWVzc2FnZTogIueZu+W9leaIkOWKnyIgfSk7DQogICAgICAgIHNldFRva2VuKHJlcy5kYXRhLmRhdGEudG9rZW4pOw0KICAgICAgICBzZXRTdG9yYWdlKCJyZWZyZXNoX3Rva2VuIiwgcmVzLmRhdGEuZGF0YS5yZWZyZXNoX3Rva2VuKTsNCg0KICAgICAgICAvLyDot7PovazkuIDlrpropoHlhpnlnKjmnIDlkI7vvIzlsL3ph4/mnIDlkI7miafooYwNCiAgICAgICAgLy8gbG9jYXRpb24uaHJlZjrlvZPliY3mtY/op4jlmajlnLDlnYDlkozopoHot7PovaznmoTlnLDlnYDkuIDmoLfvvIjkuI3ljIXlkKvplJrngrkj5LmL5ZCO55qE5L+h5oGv77yJ77yM5LiN5Lya5Yi35paw572R6aG1DQogICAgICAgIC8vIHRoaXMuJHJvdXRlci5wdXNoKCkg5Y6L5qCI77yM5Lya5Lqn55Sf5Y6G5Y+y6K6w5b2V77yM5Y+v5Lul5Zue6YCADQogICAgICAgIC8vIHRoaXMuJHJvdXRlci5yZXBsYWNlKCkg5pu/5o2i77yM5LiN5Lya5Lqn55Sf5Y6G5Y+y6K6w5b2VDQogICAgICAgIHRoaXMuJHJvdXRlci5yZXBsYWNlKHsNCiAgICAgICAgICAvLyDnmbvlvZXmnKrpgYLlnLDlnYANCiAgICAgICAgICBwYXRoOiB0aGlzLiRyb3V0ZS5xdWVyeS5wYXRoIHx8ICIvbGF5b3V0L2hvbWUiIC8v5Zug5Li65oiR5Lus6Lev55Sx6KeE5YiZ6YeMbGF5b3V05rKh5pyJ6YeN5a6a5ZCR77yM5omA5Lul6L+Z6YeM5YaZ5YWoDQogICAgICAgIH0pOw0KICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgLy8gY29uc29sZS5sb2coZXJyb3IpOw0KDQogICAgICAgIC8vIOWNsemZqemAmuefpQ0KICAgICAgICBOb3RpZnkoeyB0eXBlOiAiZGFuZ2VyIiwgbWVzc2FnZTogIui0puWPt+aIluWvhueggemUmeivryIgfSk7DQogICAgICB9DQogICAgICAvLyDml6DorrrnvZHnu5zor7fmsYLmiJDlip/ov5jmmK/lpLHotKXvvIzmiormjInpkq7nirbmgIHlhbPkuoYNCiAgICAgIHRoaXMuaXNsb2FkaW5nID0gZmFsc2U7DQogICAgfQ0KICB9DQp9Ow0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAyCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/Login","sourcesContent":["<template>\r\n  <div>\r\n    <!-- 导航栏 -->\r\n    <van-nav-bar title=\"黑马头条-登录\" />\r\n    <!-- /导航栏 -->\r\n\r\n    <!-- 登录表单 -->\r\n    <van-form @submit=\"onSubmit\">\r\n      <van-field\r\n        v-model=\"user.mobile\"\r\n        required\r\n        name=\"mobile\"\r\n        label=\"手机号\"\r\n        placeholder=\"请输入11位手机号\"\r\n        :rules=\"[{ required: true, message: '请填写正确的手机号',pattern:/^1[3-9]\\d{9}$/ }]\"\r\n      />\r\n      <van-field\r\n        v-model=\"user.code\"\r\n        required\r\n        type=\"password\"\r\n        name=\"code\"\r\n        label=\"密码\"\r\n        placeholder=\"请输入6位密码\"\r\n        :rules=\"[{ required: true, message: '请填写密码',pattern: /^\\d{6}$/ }]\"\r\n      />\r\n      <div style=\"margin: 16px;\">\r\n        <van-button\r\n          round\r\n          block\r\n          type=\"info\"\r\n          native-type=\"submit\"\r\n          :loading=\"isloading\"\r\n          loading-text=\"正在登录中...\"\r\n          :disabled=\"isloading\"\r\n        >登录</van-button>\r\n      </div>\r\n    </van-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { loginAPI } from \"@/api\";\r\nimport Notify from \"@/ui/Notify.js\";\r\nimport { setToken } from \"@/utils/token.js\";\r\nimport { setStorage } from \"@/utils/storage.js\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      user: {\r\n        mobile: \"\", //手机号\r\n        code: \"\" //密码\r\n      },\r\n      isloading: false\r\n    };\r\n  },\r\n  methods: {\r\n    async onSubmit(values) {\r\n      // console.log(\"submit\", values);\r\n      // console.log(this.user);\r\n      // 把状态设置为true\r\n      this.isloading = true;\r\n\r\n      try {\r\n        const res = await loginAPI(this.user);\r\n        // console.log(res);\r\n        // 成功通知\r\n        Notify({ type: \"success\", message: \"登录成功\" });\r\n        setToken(res.data.data.token);\r\n        setStorage(\"refresh_token\", res.data.data.refresh_token);\r\n\r\n        // 跳转一定要写在最后，尽量最后执行\r\n        // location.href:当前浏览器地址和要跳转的地址一样（不包含锚点#之后的信息），不会刷新网页\r\n        // this.$router.push() 压栈，会产生历史记录，可以回退\r\n        // this.$router.replace() 替换，不会产生历史记录\r\n        this.$router.replace({\r\n          // 登录未遂地址\r\n          path: this.$route.query.path || \"/layout/home\" //因为我们路由规则里layout没有重定向，所以这里写全\r\n        });\r\n      } catch (error) {\r\n        // console.log(error);\r\n\r\n        // 危险通知\r\n        Notify({ type: \"danger\", message: \"账号或密码错误\" });\r\n      }\r\n      // 无论网络请求成功还是失败，把按钮状态关了\r\n      this.isloading = false;\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.van-nav-bar {\r\n  background-color: #007bff;\r\n}\r\n/deep/ .van-field__label {\r\n  padding-left: 30px !important;\r\n  // text-align: center !important;\r\n}\r\n/deep/ .van-nav-bar__title {\r\n  color: white;\r\n}\r\n</style>\r\n"]}]}