{"remainingRequest":"D:\\forward\\code\\vue\\hmtt_nnew\\node_modules\\babel-loader\\lib\\index.js!D:\\forward\\code\\vue\\hmtt_nnew\\src\\utils\\request.js","dependencies":[{"path":"D:\\forward\\code\\vue\\hmtt_nnew\\src\\utils\\request.js","mtime":1667286274735},{"path":"D:\\forward\\code\\vue\\hmtt_nnew\\babel.config.js","mtime":1664795892678},{"path":"D:\\forward\\code\\vue\\hmtt_nnew\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1664795348110},{"path":"D:\\forward\\code\\vue\\hmtt_nnew\\node_modules\\babel-loader\\lib\\index.js","mtime":1663989856865}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHRoZUF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IHsgRGlyIH0gZnJvbSAnZnMnOyAvLyBpbXBvcnQgcm91dGVyIGZyb20gJ0Avcm91dGVyJwoKaW1wb3J0IHsgZ2V0VG9rZW4sIHJlbW92ZVRva2VuLCBzZXRUb2tlbiB9IGZyb20gJ0AvdXRpbHMvdG9rZW4uanMnOwppbXBvcnQgeyBnZXROZXdUb2tlbkFQSSB9IGZyb20gJ0AvYXBpJzsKY29uc3QgYXhpb3MgPSB0aGVBeGlvcy5jcmVhdGUoewogIGJhc2VVUkw6ICdodHRwOi8vdG91dGlhby5pdGhlaW1hLm5ldCcsCiAgdGltZW91dDogMjAwMDAKfSk7IC8vIOa3u+WKoOivt+axguaLpuaIquWZqAoKYXhpb3MuaW50ZXJjZXB0b3JzLnJlcXVlc3QudXNlKGZ1bmN0aW9uIChjb25maWcpIHsKICAvLyBjb25zb2xlLmxvZyhjb25maWcpOwogIC8vIOWcqOWPkemAgeivt+axguS5i+WJjeWBmuS6m+S7gOS5iAogIC8vIOebruagh++8mue7n+S4gOaQuuW4pnRva2VuCiAgLy8g5Yik5pat5pys5Zyw5pyJ5pegdG9rZW7lho3mkLrluKYKICBpZiAoZ2V0VG9rZW4oKSAmJiBnZXRUb2tlbigpLmxlbmd0aCA+IDAgJiYgY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9PT0gdW5kZWZpbmVkKSB7CiAgICAvLyDlpoLmnpzmnIl0b2tlbu+8jOayoeacieaQuuW4pkF1dGhvcml6YXRpb24s5re75Yqg5LiK5Y6777yM5Y+R6YCB6K+35rGC5pe25bCx5LiN55So5YaN6Ieq5bex6YWN572uaGVhZGVyc+S6hgogICAgY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9IGBCZWFyZXIgJHtnZXRUb2tlbigpfWA7CiAgfQoKICByZXR1cm4gY29uZmlnOwp9LCBmdW5jdGlvbiAoZXJyb3IpIHsKICAvLyDlr7nor7fmsYLplJnor6/lgZrkupvku4DkuYgKICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpOwp9KTsgLy8g5re75Yqg5ZON5bqU5oum5oiq5ZmoCgpheGlvcy5pbnRlcmNlcHRvcnMucmVzcG9uc2UudXNlKGZ1bmN0aW9uIChyZXNwb25zZSkgewogIC8vIDJ4eCDojIPlm7TlhoXnmoTnirbmgIHnoIHpg73kvJrop6blj5Hor6Xlh73mlbDjgIIKICAvLyDlr7nlk43lupTmlbDmja7lgZrngrnku4DkuYgKICByZXR1cm4gcmVzcG9uc2U7Cn0sIGFzeW5jIGZ1bmN0aW9uIChlcnJvcikgewogIC8vIOi2heWHuiAyeHgg6IyD5Zu055qE54q25oCB56CB6YO95Lya6Kem5Y+R6K+l5Ye95pWw44CCCiAgLy8g5a+55ZON5bqU6ZSZ6K+v5YGa54K55LuA5LmICiAgY29uc29sZS5kaXIoZXJyb3IpOyAvLyBjb25zb2xlLmxvZyh0aGlzKTsKICAvLyBjb25zb2xlLmxvZyhlcnJvcik7CiAgLy8g5Y+q5pyJNDAx5omN5Luj6KGo6Lqr5Lu96L+H5pyf77yM6ZyA6KaB6Lez6L2sCgogIGlmIChlcnJvci5yZXNwb25zZS5zdGF0dXMgPT09IDQwMSkgewogICAgLy8g5LiN6IO95L2/55SodGhpcyzlm6DkuLp0aGlz5LiN5pivdnVl57uE5Lu25a+56LGh5peg5rOV6LCD55SoCiAgICAvLyB0aGlzLiRyb3V0ZXIucmVwbGFjZSgnL2xvZ2luJykKICAgIC8vIOino+WGs++8mnRoaXMuJHJvdXRlcuaYr+aLv3JvdXRlcui3r+eUseWvueixoe+8jOi/memHjOWPr+S7peWvvOWFpei/m+adpeebtOaOpeS9v+eUqAogICAgcmVtb3ZlVG9rZW4oKTsgLy/muIXpmaTlpLHmlYh0b2tlbu+8jOinpuWPkei3r+eUseWuiOWNq++8jOaUvuihjOWIsOeZu+W9lemhtQogICAgLy8g5pa55byPMTrlvLrliLbnlKjmiLfot7PovazliLDnmbvlvZXpobXjgILnlKjmiLfmnInmhJ/nn6UKICAgIC8vIE5vdGlmeSh7IHR5cGU6ICd3YXJuaW5nJywgbWVzc2FnZTogJ+i6q+S7veW3sui/h+acn++8jOivt+mHjeaWsOeZu+W9lScgfSkKICAgIC8vIHJvdXRlci5yZXBsYWNlKCcvbG9naW4nKQogICAgLy8g5pa55byPMu+8muS9v+eUqHJlZnJlc2hfdG9rZW7mjaLlm57mlrDnmoR0b2tlbue7p+e7reS9v+eUqO+8jEpT5Luj56CB5a6e546w77yM55So5oi35peg5oSf55+l77yI5L2T6aqM5aW977yJCgogICAgY29uc3QgcmVzID0gYXdhaXQgZ2V0TmV3VG9rZW5BUEkoKTsgLy8gY29uc29sZS5sb2cocmVzKTsKICAgIC8vIOaWsOeahHRva2Vu5Zue5p2l5LmL5ZCO77yM5oiR5LmI5Lus6KaB5YGa55qECiAgICAvLyAx77yM5Zyo5pys5Zyw5pu05pawdG9rZW4KCiAgICBzZXRUb2tlbihyZXMuZGF0YS5kYXRhLnRva2VuKTsgLy8gMi7lnKjor7fmsYLlpLTph4zmm7TmlrB0b2tlbgoKICAgIGVycm9yLmNvbmZpZy5oZWFkZXJzLkF1dGhvcml6YXRpb24gPSBgQmVhcmVyICR7cmVzLmRhdGEuZGF0YS50b2tlbn1gOyAvLyAzLuacquWujOaIkOeahOacrOasoeivt+axgu+8jOWGjeasoeWPkei1twogICAgLy8gZXJyb3IuY29uZmln5bCx5piv5LiK5LiA5qyh6K+35rGC55qE6YWN572u5a+56LGhCgogICAgcmV0dXJuIGF4aW9zKGVycm9yLmNvbmZpZyk7CiAgfQoKICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpOwp9KTsKZXhwb3J0IGRlZmF1bHQgKCh7CiAgdXJsLAogIG1ldGhvZCA9ICdHRVQnLAogIHBhcmFtcyA9IHt9LAogIGRhdGEgPSB7fSwKICBoZWFkZXJzID0ge30KfSkgPT4gewogIHJldHVybiBheGlvcyh7CiAgICB1cmwsCiAgICBtZXRob2QsCiAgICBwYXJhbXMsCiAgICBkYXRhLAogICAgaGVhZGVycwogIH0pOwp9KTs="},{"version":3,"names":["theAxios","Dir","getToken","removeToken","setToken","getNewTokenAPI","axios","create","baseURL","timeout","interceptors","request","use","config","length","headers","Authorization","undefined","error","Promise","reject","response","console","dir","status","res","data","token","url","method","params"],"sources":["D:/forward/code/vue/hmtt_nnew/src/utils/request.js"],"sourcesContent":["import theAxios from 'axios'\nimport { Dir } from 'fs';\n// import router from '@/router'\nimport { Notify } from 'vant'\nimport { getToken, removeToken, setToken } from '@/utils/token.js'\nimport { getNewTokenAPI } from '@/api'\n\nconst axios = theAxios.create({\n    baseURL: 'http://toutiao.itheima.net',\n    timeout: 20000\n})\n\n// 添加请求拦截器\naxios.interceptors.request.use(function(config) {\n    // console.log(config);\n    // 在发送请求之前做些什么\n    // 目标：统一携带token\n    // 判断本地有无token再携带\n    if (getToken() && getToken().length > 0 && config.headers.Authorization === undefined) {\n        // 如果有token，没有携带Authorization,添加上去，发送请求时就不用再自己配置headers了\n        config.headers.Authorization = `Bearer ${getToken()}`\n    }\n\n    return config;\n}, function(error) {\n    // 对请求错误做些什么\n    return Promise.reject(error);\n});\n\n// 添加响应拦截器\naxios.interceptors.response.use(function(response) {\n    // 2xx 范围内的状态码都会触发该函数。\n    // 对响应数据做点什么\n    return response;\n}, async function(error) {\n    // 超出 2xx 范围的状态码都会触发该函数。\n    // 对响应错误做点什么\n    console.dir(error)\n        // console.log(this);\n        // console.log(error);\n\n\n    // 只有401才代表身份过期，需要跳转\n    if (error.response.status === 401) {\n        // 不能使用this,因为this不是vue组件对象无法调用\n        // this.$router.replace('/login')\n        // 解决：this.$router是拿router路由对象，这里可以导入进来直接使用\n\n        removeToken() //清除失效token，触发路由守卫，放行到登录页\n            // 方式1:强制用户跳转到登录页。用户有感知\n            // Notify({ type: 'warning', message: '身份已过期，请重新登录' })\n\n        // router.replace('/login')\n\n        // 方式2：使用refresh_token换回新的token继续使用，JS代码实现，用户无感知（体验好）\n        const res = await getNewTokenAPI()\n            // console.log(res);\n            // 新的token回来之后，我么们要做的\n            // 1，在本地更新token\n        setToken(res.data.data.token)\n            // 2.在请求头里更新token\n        error.config.headers.Authorization = `Bearer ${res.data.data.token}`\n            // 3.未完成的本次请求，再次发起\n            // error.config就是上一次请求的配置对象\n        return axios(error.config)\n\n\n    }\n    return Promise.reject(error);\n});\n\nexport default ({ url, method = 'GET', params = {}, data = {}, headers = {} }) => {\n    return axios({\n        url,\n        method,\n        params,\n        data,\n        headers\n    })\n}"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,OAArB;AACA,SAASC,GAAT,QAAoB,IAApB,C,CACA;;AAEA,SAASC,QAAT,EAAmBC,WAAnB,EAAgCC,QAAhC,QAAgD,kBAAhD;AACA,SAASC,cAAT,QAA+B,OAA/B;AAEA,MAAMC,KAAK,GAAGN,QAAQ,CAACO,MAAT,CAAgB;EAC1BC,OAAO,EAAE,4BADiB;EAE1BC,OAAO,EAAE;AAFiB,CAAhB,CAAd,C,CAKA;;AACAH,KAAK,CAACI,YAAN,CAAmBC,OAAnB,CAA2BC,GAA3B,CAA+B,UAASC,MAAT,EAAiB;EAC5C;EACA;EACA;EACA;EACA,IAAIX,QAAQ,MAAMA,QAAQ,GAAGY,MAAX,GAAoB,CAAlC,IAAuCD,MAAM,CAACE,OAAP,CAAeC,aAAf,KAAiCC,SAA5E,EAAuF;IACnF;IACAJ,MAAM,CAACE,OAAP,CAAeC,aAAf,GAAgC,UAASd,QAAQ,EAAG,EAApD;EACH;;EAED,OAAOW,MAAP;AACH,CAXD,EAWG,UAASK,KAAT,EAAgB;EACf;EACA,OAAOC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACH,CAdD,E,CAgBA;;AACAZ,KAAK,CAACI,YAAN,CAAmBW,QAAnB,CAA4BT,GAA5B,CAAgC,UAASS,QAAT,EAAmB;EAC/C;EACA;EACA,OAAOA,QAAP;AACH,CAJD,EAIG,gBAAeH,KAAf,EAAsB;EACrB;EACA;EACAI,OAAO,CAACC,GAAR,CAAYL,KAAZ,EAHqB,CAIjB;EACA;EAGJ;;EACA,IAAIA,KAAK,CAACG,QAAN,CAAeG,MAAf,KAA0B,GAA9B,EAAmC;IAC/B;IACA;IACA;IAEArB,WAAW,GALoB,CAKjB;IACV;IACA;IAEJ;IAEA;;IACA,MAAMsB,GAAG,GAAG,MAAMpB,cAAc,EAAhC,CAZ+B,CAa3B;IACA;IACA;;IACJD,QAAQ,CAACqB,GAAG,CAACC,IAAJ,CAASA,IAAT,CAAcC,KAAf,CAAR,CAhB+B,CAiB3B;;IACJT,KAAK,CAACL,MAAN,CAAaE,OAAb,CAAqBC,aAArB,GAAsC,UAASS,GAAG,CAACC,IAAJ,CAASA,IAAT,CAAcC,KAAM,EAAnE,CAlB+B,CAmB3B;IACA;;IACJ,OAAOrB,KAAK,CAACY,KAAK,CAACL,MAAP,CAAZ;EAGH;;EACD,OAAOM,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACH,CAvCD;AAyCA,gBAAe,CAAC;EAAEU,GAAF;EAAOC,MAAM,GAAG,KAAhB;EAAuBC,MAAM,GAAG,EAAhC;EAAoCJ,IAAI,GAAG,EAA3C;EAA+CX,OAAO,GAAG;AAAzD,CAAD,KAAmE;EAC9E,OAAOT,KAAK,CAAC;IACTsB,GADS;IAETC,MAFS;IAGTC,MAHS;IAITJ,IAJS;IAKTX;EALS,CAAD,CAAZ;AAOH,CARD"}]}