{"remainingRequest":"D:\\myProject\\touTiaoNews\\node_modules\\babel-loader\\lib\\index.js!D:\\myProject\\touTiaoNews\\src\\utils\\request.js","dependencies":[{"path":"D:\\myProject\\touTiaoNews\\src\\utils\\request.js","mtime":1694051857320},{"path":"D:\\myProject\\touTiaoNews\\babel.config.js","mtime":1694051857305},{"path":"D:\\myProject\\touTiaoNews\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1664795348110},{"path":"D:\\myProject\\touTiaoNews\\node_modules\\babel-loader\\lib\\index.js","mtime":1663989856865}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHRoZUF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IHsgRGlyIH0gZnJvbSAnZnMnOwppbXBvcnQgcm91dGVyIGZyb20gJ0Avcm91dGVyJzsKaW1wb3J0IE5vdGlmeSBmcm9tICdAL3VpL05vdGlmeS5qcyc7CmltcG9ydCB7IGdldFRva2VuLCByZW1vdmVUb2tlbiwgc2V0VG9rZW4gfSBmcm9tICdAL3V0aWxzL3Rva2VuLmpzJzsKaW1wb3J0IHsgZ2V0TmV3VG9rZW5BUEkgfSBmcm9tICdAL2FwaSc7CmNvbnN0IGF4aW9zID0gdGhlQXhpb3MuY3JlYXRlKHsKICBiYXNlVVJMOiAnaHR0cDovL3RvdXRpYW8uaXRoZWltYS5uZXQnLAogIHRpbWVvdXQ6IDIwMDAwCn0pOyAvLyDmt7vliqDor7fmsYLmi6bmiKrlmagKCmF4aW9zLmludGVyY2VwdG9ycy5yZXF1ZXN0LnVzZShmdW5jdGlvbiAoY29uZmlnKSB7CiAgLy8gY29uc29sZS5sb2coY29uZmlnKTsKICAvLyDlnKjlj5HpgIHor7fmsYLkuYvliY3lgZrkupvku4DkuYgKICAvLyDnm67moIfvvJrnu5/kuIDmkLrluKZ0b2tlbgogIC8vIOWIpOaWreacrOWcsOacieaXoHRva2Vu5YaN5pC65bimCiAgaWYgKGdldFRva2VuKCkgJiYgZ2V0VG9rZW4oKS5sZW5ndGggPiAwICYmIGNvbmZpZy5oZWFkZXJzLkF1dGhvcml6YXRpb24gPT09IHVuZGVmaW5lZCkgewogICAgLy8g5aaC5p6c5pyJdG9rZW7vvIzmsqHmnInmkLrluKZBdXRob3JpemF0aW9uLOa3u+WKoOS4iuWOu++8jOWPkemAgeivt+axguaXtuWwseS4jeeUqOWGjeiHquW3semFjee9rmhlYWRlcnPkuoYKICAgIGNvbmZpZy5oZWFkZXJzLkF1dGhvcml6YXRpb24gPSBgQmVhcmVyICR7Z2V0VG9rZW4oKX1gOwogIH0KCiAgcmV0dXJuIGNvbmZpZzsKfSwgZnVuY3Rpb24gKGVycm9yKSB7CiAgLy8g5a+56K+35rGC6ZSZ6K+v5YGa5Lqb5LuA5LmICiAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTsKfSk7IC8vIOa3u+WKoOWTjeW6lOaLpuaIquWZqAoKYXhpb3MuaW50ZXJjZXB0b3JzLnJlc3BvbnNlLnVzZShmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAvLyAyeHgg6IyD5Zu05YaF55qE54q25oCB56CB6YO95Lya6Kem5Y+R6K+l5Ye95pWw44CCCiAgLy8g5a+55ZON5bqU5pWw5o2u5YGa54K55LuA5LmICiAgcmV0dXJuIHJlc3BvbnNlOwp9LCBhc3luYyBmdW5jdGlvbiAoZXJyb3IpIHsKICAvLyDotoXlh7ogMnh4IOiMg+WbtOeahOeKtuaAgeeggemDveS8muinpuWPkeivpeWHveaVsOOAggogIC8vIOWvueWTjeW6lOmUmeivr+WBmueCueS7gOS5iAogIC8vIGNvbnNvbGUuZGlyKGVycm9yKQogIC8vIGNvbnNvbGUubG9nKHRoaXMpOwogIC8vIGNvbnNvbGUubG9nKGVycm9yKTsKICAvLyDlj6rmnIk0MDHmiY3ku6Pooajouqvku73ov4fmnJ/vvIzpnIDopoHot7PovawKICBpZiAoZXJyb3IucmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHsKICAgIC8vIOS4jeiDveS9v+eUqHRoaXMs5Zug5Li6dGhpc+S4jeaYr3Z1Zee7hOS7tuWvueixoeaXoOazleiwg+eUqAogICAgLy8gdGhpcy4kcm91dGVyLnJlcGxhY2UoJy9sb2dpbicpCiAgICAvLyDop6PlhrPvvJp0aGlzLiRyb3V0ZXLmmK/mi79yb3V0ZXLot6/nlLHlr7nosaHvvIzov5nph4zlj6/ku6Xlr7zlhaXov5vmnaXnm7TmjqXkvb/nlKgKICAgIHJlbW92ZVRva2VuKCk7IC8v5riF6Zmk5aSx5pWIdG9rZW7vvIzop6blj5Hot6/nlLHlrojljavvvIzmlL7ooYzliLDnmbvlvZXpobUKICAgIC8vIOaWueW8jzE65by65Yi255So5oi36Lez6L2s5Yiw55m75b2V6aG144CC55So5oi35pyJ5oSf55+lCiAgICAvLyBOb3RpZnkoeyB0eXBlOiAnd2FybmluZycsIG1lc3NhZ2U6ICfouqvku73lt7Lov4fmnJ/vvIzor7fph43mlrDnmbvlvZUnIH0pCiAgICAvLyDnmbvlvZXmnKrpgYLlnLDlnYAKICAgIC8vIHJvdXRlci5jdXJyZW50Um91dGXkuLrlvZPliY3ot6/nlLHlr7nosaEKICAgIC8vIGZ1bGxQYXRoLOi3r+eUseWvueixoemHjOWujOaVtOi3r+eUsei3r+W+hCPlkI7pnaLnmoTkuIDliIcKCiAgICByb3V0ZXIucmVwbGFjZShgL2xvZ2luP3BhdGg9JHtyb3V0ZXIuY3VycmVudFJvdXRlLmZ1bGxQYXRofWApOyAvLyAgICAgLy8g5pa55byPMu+8muS9v+eUqHJlZnJlc2hfdG9rZW7mjaLlm57mlrDnmoR0b2tlbue7p+e7reS9v+eUqO+8jEpT5Luj56CB5a6e546w77yM55So5oi35peg5oSf55+l77yI5L2T6aqM5aW977yJCiAgICAvLyAgICAgY29uc3QgcmVzID0gYXdhaXQgZ2V0TmV3VG9rZW5BUEkoKQogICAgLy8gICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMpOwogICAgLy8gICAgICAgICAvLyDmlrDnmoR0b2tlbuWbnuadpeS5i+WQju+8jOaIkeS5iOS7rOimgeWBmueahAogICAgLy8gICAgICAgICAvLyAx77yM5Zyo5pys5Zyw5pu05pawdG9rZW4KICAgIC8vICAgICBzZXRUb2tlbihyZXMuZGF0YS5kYXRhLnRva2VuKQogICAgLy8gICAgICAgICAvLyAyLuWcqOivt+axguWktOmHjOabtOaWsHRva2VuCiAgICAvLyAgICAgZXJyb3IuY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9IGBCZWFyZXIgJHtyZXMuZGF0YS5kYXRhLnRva2VufWAKICAgIC8vICAgICAgICAgLy8gMy7mnKrlrozmiJDnmoTmnKzmrKHor7fmsYLvvIzlho3mrKHlj5HotbcKICAgIC8vICAgICAgICAgLy8gZXJyb3IuY29uZmln5bCx5piv5LiK5LiA5qyh6K+35rGC55qE6YWN572u5a+56LGhCiAgICAvLyAgICAgcmV0dXJuIGF4aW9zKGVycm9yLmNvbmZpZykKICAgIC8vIH0gZWxzZSBpZiAoZXJyb3IucmVzcG9uc2Uuc3RhdHVzID09PSA1MDAgJiYgZXJyb3IuY29uZmlnLnVybCA9PT0gJy92MV8wL2F1dGhvcml6YXRpb25zJyAmJiBlcnJvci5jb25maWcubWV0aG9kID09PSAncHV0JykgewogICAgLy8gICAgIC8vIOatpOaXtnJlZnJlc2hfdG9rZW7kuZ/ov4fmnJ/kuoYKICAgIC8vICAgICBsb2NhbFN0b3JhZ2UuY2xlYXIoKSAvL+a4hemZpGxvY2FsU3RvcmFnZemHjOeahOaJgOacieWAvAogICAgLy8gICAgIE5vdGlmeSh7IHR5cGU6ICd3YXJuaW5nJywgbWVzc2FnZTogJ+i6q+S7veW3sui/h+acn++8jOivt+mHjeaWsOeZu+W9lScgfSkKICAgIC8vICAgICByb3V0ZXIucmVwbGFjZSgnL2xvZ2luJykKICB9CgogIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7Cn0pOwpleHBvcnQgZGVmYXVsdCAoKHsKICB1cmwsCiAgbWV0aG9kID0gJ0dFVCcsCiAgcGFyYW1zID0ge30sCiAgZGF0YSA9IHt9LAogIGhlYWRlcnMgPSB7fQp9KSA9PiB7CiAgcmV0dXJuIGF4aW9zKHsKICAgIHVybCwKICAgIG1ldGhvZCwKICAgIHBhcmFtcywKICAgIGRhdGEsCiAgICBoZWFkZXJzCiAgfSk7Cn0pOw=="},{"version":3,"names":["theAxios","Dir","router","Notify","getToken","removeToken","setToken","getNewTokenAPI","axios","create","baseURL","timeout","interceptors","request","use","config","length","headers","Authorization","undefined","error","Promise","reject","response","status","replace","currentRoute","fullPath","url","method","params","data"],"sources":["D:/myProject/touTiaoNews/src/utils/request.js"],"sourcesContent":["import theAxios from 'axios'\r\nimport { Dir } from 'fs';\r\nimport router from '@/router'\r\nimport Notify from '@/ui/Notify.js'\r\nimport { getToken, removeToken, setToken } from '@/utils/token.js'\r\nimport { getNewTokenAPI } from '@/api'\r\n\r\nconst axios = theAxios.create({\r\n    baseURL: 'http://toutiao.itheima.net',\r\n    timeout: 20000\r\n})\r\n\r\n// 添加请求拦截器\r\naxios.interceptors.request.use(function(config) {\r\n    // console.log(config);\r\n    // 在发送请求之前做些什么\r\n    // 目标：统一携带token\r\n    // 判断本地有无token再携带\r\n    if (getToken() && getToken().length > 0 && config.headers.Authorization === undefined) {\r\n        // 如果有token，没有携带Authorization,添加上去，发送请求时就不用再自己配置headers了\r\n        config.headers.Authorization = `Bearer ${getToken()}`\r\n    }\r\n\r\n    return config;\r\n}, function(error) {\r\n    // 对请求错误做些什么\r\n    return Promise.reject(error);\r\n});\r\n\r\n// 添加响应拦截器\r\naxios.interceptors.response.use(function(response) {\r\n    // 2xx 范围内的状态码都会触发该函数。\r\n    // 对响应数据做点什么\r\n    return response;\r\n}, async function(error) {\r\n    // 超出 2xx 范围的状态码都会触发该函数。\r\n    // 对响应错误做点什么\r\n    // console.dir(error)\r\n    // console.log(this);\r\n    // console.log(error);\r\n\r\n\r\n    // 只有401才代表身份过期，需要跳转\r\n    if (error.response.status === 401) {\r\n        // 不能使用this,因为this不是vue组件对象无法调用\r\n        // this.$router.replace('/login')\r\n        // 解决：this.$router是拿router路由对象，这里可以导入进来直接使用\r\n\r\n        removeToken() //清除失效token，触发路由守卫，放行到登录页\r\n            // 方式1:强制用户跳转到登录页。用户有感知\r\n            // Notify({ type: 'warning', message: '身份已过期，请重新登录' })\r\n\r\n        // 登录未遂地址\r\n        // router.currentRoute为当前路由对象\r\n        // fullPath,路由对象里完整路由路径#后面的一切\r\n        router.replace(`/login?path=${router.currentRoute.fullPath}`)\r\n\r\n        //     // 方式2：使用refresh_token换回新的token继续使用，JS代码实现，用户无感知（体验好）\r\n        //     const res = await getNewTokenAPI()\r\n        //         // console.log(res);\r\n        //         // 新的token回来之后，我么们要做的\r\n        //         // 1，在本地更新token\r\n        //     setToken(res.data.data.token)\r\n        //         // 2.在请求头里更新token\r\n        //     error.config.headers.Authorization = `Bearer ${res.data.data.token}`\r\n        //         // 3.未完成的本次请求，再次发起\r\n        //         // error.config就是上一次请求的配置对象\r\n        //     return axios(error.config)\r\n\r\n\r\n        // } else if (error.response.status === 500 && error.config.url === '/v1_0/authorizations' && error.config.method === 'put') {\r\n        //     // 此时refresh_token也过期了\r\n        //     localStorage.clear() //清除localStorage里的所有值\r\n        //     Notify({ type: 'warning', message: '身份已过期，请重新登录' })\r\n        //     router.replace('/login')\r\n\r\n    }\r\n    return Promise.reject(error);\r\n});\r\n\r\nexport default ({ url, method = 'GET', params = {}, data = {}, headers = {} }) => {\r\n    return axios({\r\n        url,\r\n        method,\r\n        params,\r\n        data,\r\n        headers\r\n    })\r\n}"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,OAArB;AACA,SAASC,GAAT,QAAoB,IAApB;AACA,OAAOC,MAAP,MAAmB,UAAnB;AACA,OAAOC,MAAP,MAAmB,gBAAnB;AACA,SAASC,QAAT,EAAmBC,WAAnB,EAAgCC,QAAhC,QAAgD,kBAAhD;AACA,SAASC,cAAT,QAA+B,OAA/B;AAEA,MAAMC,KAAK,GAAGR,QAAQ,CAACS,MAAT,CAAgB;EAC1BC,OAAO,EAAE,4BADiB;EAE1BC,OAAO,EAAE;AAFiB,CAAhB,CAAd,C,CAKA;;AACAH,KAAK,CAACI,YAAN,CAAmBC,OAAnB,CAA2BC,GAA3B,CAA+B,UAASC,MAAT,EAAiB;EAC5C;EACA;EACA;EACA;EACA,IAAIX,QAAQ,MAAMA,QAAQ,GAAGY,MAAX,GAAoB,CAAlC,IAAuCD,MAAM,CAACE,OAAP,CAAeC,aAAf,KAAiCC,SAA5E,EAAuF;IACnF;IACAJ,MAAM,CAACE,OAAP,CAAeC,aAAf,GAAgC,UAASd,QAAQ,EAAG,EAApD;EACH;;EAED,OAAOW,MAAP;AACH,CAXD,EAWG,UAASK,KAAT,EAAgB;EACf;EACA,OAAOC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACH,CAdD,E,CAgBA;;AACAZ,KAAK,CAACI,YAAN,CAAmBW,QAAnB,CAA4BT,GAA5B,CAAgC,UAASS,QAAT,EAAmB;EAC/C;EACA;EACA,OAAOA,QAAP;AACH,CAJD,EAIG,gBAAeH,KAAf,EAAsB;EACrB;EACA;EACA;EACA;EACA;EAGA;EACA,IAAIA,KAAK,CAACG,QAAN,CAAeC,MAAf,KAA0B,GAA9B,EAAmC;IAC/B;IACA;IACA;IAEAnB,WAAW,GALoB,CAKjB;IACV;IACA;IAEJ;IACA;IACA;;IACAH,MAAM,CAACuB,OAAP,CAAgB,eAAcvB,MAAM,CAACwB,YAAP,CAAoBC,QAAS,EAA3D,EAZ+B,CAc/B;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAGA;IACA;IACA;IACA;IACA;EAEH;;EACD,OAAON,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACH,CAhDD;AAkDA,gBAAe,CAAC;EAAEQ,GAAF;EAAOC,MAAM,GAAG,KAAhB;EAAuBC,MAAM,GAAG,EAAhC;EAAoCC,IAAI,GAAG,EAA3C;EAA+Cd,OAAO,GAAG;AAAzD,CAAD,KAAmE;EAC9E,OAAOT,KAAK,CAAC;IACToB,GADS;IAETC,MAFS;IAGTC,MAHS;IAITC,IAJS;IAKTd;EALS,CAAD,CAAZ;AAOH,CARD"}]}